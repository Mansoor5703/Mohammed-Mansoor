""" Automated-email-sender
Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1qNWv5fz8pLNCwGmErZQkoKmgQ1FTeAs0?usp=sharing
"""

import os

# Set environment variables
os.environ['EMAIL'] = 'mohammedmansoor.le23.csd@anits.edu.in'
os.environ['PASSWORD'] = 'anits123'
os.environ['TO_EMAIL'] = 'mohammadmansoor081@gmail.com'

# Verify environment variables are set
print("EMAIL:", os.environ.get('EMAIL'))
print("TO_EMAIL:", os.environ.get('TO_EMAIL'))

import smtplib
from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText
import os

def send_email(subject, body, to_email, from_email, smtp_server, smtp_port, login, password):
   # Create the email message
    msg = MIMEMultipart()
    msg['From'] = from_email
    msg['To'] = to_email
    msg['Subject'] = subject

    # Attach the email body
    msg.attach(MIMEText(body, 'plain'))

    try:
        # Set up the SMTP server
        print("Connecting to SMTP server...")
        server = smtplib.SMTP(smtp_server, smtp_port)
        server.set_debuglevel(1) # Enable debug output from the smtplib module
        server.starttls() # Secure the connection
        print("Logging in to SMTP server...")
        server.login(login, password)

        # Send the email
        print("Sending email...")
        server.send_message(msg)
        print("Email sent successfully!")
    except smtplib.SMTPAuthenticationError as e:
        print(f"SMTP Authentication Error: {e.smtp_code} - {e.smtp_error}")
    except smtplib.SMTPException as e:
        print(f"SMTP Error: {e}")
    except Exception as e:
        print(f"Error: {e}")
    finally:
        # Terminate the SMTP session
        server.quit()

if __name__ == "__main__":
    # Fetch email details from environment variables
    subject = "to check the python project"
    body = "This is a test email sent from a Google Colab notebook using Python."
    to_email = os.environ.get('TO_EMAIL')
    from_email = os.environ.get('EMAIL')
    smtp_server = "smtp.gmail.com"
    smtp_port = 587
    login = os.environ.get('EMAIL')
    password = os.environ.get('PASSWORD')

    # Verify environment variables
    print("Subject:", subject)
    print("Body:", body)
    print("To Email:", to_email)
    print("From Email:", from_email)

    # Send the email
    send_email(subject, body, to_email, from_email, smtp_server, smtp_port, login, password)
